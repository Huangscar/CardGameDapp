# CardGameDapp

## 一、运行方式

使用 ganache

1. 运行ganache

2. 进入项目目录内，打开命令行，输入

   ```sh
   npm install -g truffle
   ```

3. 安装需要的包

   ```sh
   npm install babel-register
   ```

4. 编译

   ```sh
   truffle compile
   ```

5. 等待编译完成，输入

   ```sh
   truffle migrate --network ganache
   ```

6. 等待部署完成，输入

   ```sh
   npm run dev
   ```

7. 在浏览器打开：`127.0.0.1:8080`

## 二、游戏说明

### 1、游戏介绍

这是一个仿照fgo设置的卡牌游戏，玩家需要登陆才能玩，玩家没有初始余额，因此需要先使用自己的数字货币支付获得游戏的余额（游戏内称为氪金），玩家没有初始英灵，因此玩家需要消耗游戏内余额来抽取英灵，抽取英灵均是看人品的，玩家可以使用自己持有的英灵战斗，也可以通过升级材料（游戏中成为狗粮）来让自己的英灵提升等级。

### 2、登陆界面

登陆界面是登陆游戏的界面。

用户输入自己已经解锁账户的地址，点击登陆即可登陆

输入的地址必须是已经存在且自行解锁过的，否则会出现登陆不了或者无法愉快玩耍的问题

如果不登陆就只能访问主页面、游戏介绍界面和登陆界面

### 3、英灵列表

英灵列表是对用户所持有的英灵的展示。

中间部分是英灵相关信息的展示，展示为星级、等级、职介、类型等。有两个按钮，其中，升级指的是通过消耗升级材料提高英灵等级，详细则是显示英灵图片。

左边是个人相关信息的展示，其中 status 指的是智能合约调用的状态，characterNum 指的是现在拥有的英灵个数，food指的是你拥有的升级材料的数量。

升级需要消耗升级材料，根据升级的级数不同，消耗的升级材料也不一样。升级材料可以通过氪金或者在战斗界面打赢敌人来获得。

### 4、抽卡界面

抽卡界面是通过消耗“石头”来从卡池中抽取英灵。

卡池分成两种，第一种是有五星、四星英灵的卡池，在这个卡池中，每抽一次消耗3个石头，你将有机会获得5星、4星英灵，但是池里也是存在1-3星英灵的，抽中概率随星级升高而降低；第二种是只有1-3星英灵的卡池，在这个卡池中，每抽一次消耗1个石头，抽中概率依旧随星级升高而降低。切换卡池可以通过点击下方两个箭头来切换

左边时抽卡状态显示：status依旧时调用智能合约相关的状态，balances显示的是当前拥有的余额，characterNum显示的是当前拥有的英灵数，recent character显示的是最新一个抽到的英灵相关信息。

### 5、氪金界面

氪金界面是通过消耗eth来增加游戏中的账户余额或增加游戏的升级材料。

这里增加余额的兑换比例是1eth对应1个石头，用户可以通过在输入框里输入想要氪的金额，并点击go按钮就可以氪金了。特别的是，石头的个数是整数，因此如果输入带有小数的我们会对这个数进行取整氪金，如果输入小于1的数，会有报错。

这里增加余额的升级材料比例是1eth对应10个升级材料，用户可以通过在输入框里输入想要氪的金额，并点击go按钮就可以氪金了。特别的是，升级材料的个数是以10为单位的整数，因此如果输入带有小数的我们会对这个数进行取整氪金，如果输入小于1的数，会有报错。

左边是氪金状态显示：status依旧时调用智能合约相关的状态，balances显示的是当前拥有的余额，food显示的是当前拥有的升级材料

### 6、战斗界面

战斗界面是选择自己拥有的英灵来与敌人战斗。

这里通过输入你拥有的英灵的序号来选择迎战的英灵。每次进入这个界面你只能选择一个，下方会显示你选择的英灵的信息，包括编号、等级、职介、星级、血量、怒气值。下方是你可以选择的卡片，通过点击卡片，你可以对地方（在右侧显示）进行攻击，战斗为回合制，每回合双方各攻击一次，用户方先攻击。当怒气值达到100时，你可以选择宝具，宝具的攻击力是普通卡片的很多倍，因此使用宝具更快将敌方打倒。

右侧显示的是地方的信息，包括等级，职介和血量，敌人没有宝具，每次攻击数值相同。

当敌方血量为0时，则判己方获胜，获胜会收到10个升级材料的奖励，同时会在左边的status显示，如果需要进行下一次战斗需要重新刷新页面；当己方血量为0时，则判敌方获胜，己方并不会有任何损失，只是会没有奖励。

左边状态显示：status依旧时调用智能合约相关的状态，characterNum显示的是当前拥有的英灵数，food显示的是当前拥有的升级材料

### 7、英灵介绍

在本游戏中，英灵的设置和fgo的设置是类似的。

英灵分为5个星级，星级越高越难获得，同时战斗力也越高；英灵分为6个职介，分别是：saber、archer、lancer、caster、rider、assasin，6个职介之间有一定的相克：saber克制lancer，被archer克制；saber克制lancer，被archer克制；lancer克制archer，被saber克制；archer克制saber，被lancer克制；caster克制assasin，被rider克制；assasin克制rider，被caser克制；rider克制caster，被assasin克制

每个英灵持有6张卡片，其中一张是宝具卡，只在怒气值达100的时候才能使用，其余五张卡片有三种类型，分别是红卡、蓝卡、绿卡。红卡是攻击力较强的卡片，但是不具有增加怒气值和暴击星的作用；蓝卡是攻击力第二的卡片，具有增加怒气值但是不具有增加暴击星的作用；绿卡虽然攻击力较弱，但是同时具有增加怒气值和暴击星的作用，但是增加怒气值数额不够蓝卡多。

英灵可以通过使用升级材料，也可称为狗粮来升级，升级后英灵的攻击能力会提高，怒气值的增加速度也会提高。

怒气值是英灵是否可以使用宝具卡的标志，获得怒气值的方法有：使用蓝卡和被敌方攻击

暴击星是增加暴击几率的物品，每回合清算，当暴击星达到一定数量后，暴击几率会变成100%。暴击指的是比普通攻击有更高的攻击力。